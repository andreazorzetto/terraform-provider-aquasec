---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "aquasec_function_runtime_policy Resource - terraform-provider-aquasec"
subcategory: ""
description: |-
  Provides a resource to manage runtime policies specific to serverless functions
---

# aquasec_function_runtime_policy (Resource)

The Function Runtime Policy resource allows you to manage security policies for serverless functions in Aqua Security. These policies define security controls and monitoring configurations specifically designed for serverless environments.

## Example Usage

### Basic Usage (Audit Mode)

```terraform
resource "aquasec_function_runtime_policy" "audit_policy" {
  name        = "function-runtime-audit"
  description = "Function runtime policy in audit mode"
  application_scopes = ["Global"]
  enabled     = true
  enforce     = false  # Audit mode
}
```

### Enforce Mode with Grace Period

```terraform
resource "aquasec_function_runtime_policy" "enforce_policy" {
  name                = "function-runtime-enforce"
  description         = "Function runtime policy with enforcement"
  application_scopes  = ["Global"]
  enabled             = true
  enforce             = true
  enforce_after_days  = 7  # Start in audit mode and enforce after 7 days
}
```

### With Scope Expression

```terraform
resource "aquasec_function_runtime_policy" "scoped_policy" {
  name        = "function-runtime-scoped"
  description = "Function runtime policy with scope expression"
  
  scope {
    expression = "v1 || v2"
    variables {
      attribute = "function.name"
      name      = "v1"
      value     = "*"
    }
    variables {
      attribute = "aqua.serverless_project"
      name      = "v2"
      value     = "example"    
    }
  }

  application_scopes = ["Global"]
  enabled            = true
  enforce            = false
}
```

### With Security Controls

```terraform
resource "aquasec_function_runtime_policy" "comprehensive_policy" {
  name                = "function-runtime-comprehensive"
  description         = "Comprehensive function runtime policy"
  application_scopes  = ["Global"]
  enabled             = true
  enforce             = true
  
  # Drift prevention (detect and prevent unauthorized changes)
  drift_prevention {
    enabled              = true
    exec_lockdown        = true
    image_lockdown       = false
    exec_lockdown_white_list = ["node", "python", "npm"]
  }
  
  # Control allowed executables
  allowed_executables {
    enabled           = true
    allow_executables = ["node", "python", "npm"]
  }
  
  # Block unauthorized executables
  executable_blacklist {
    enabled     = true
    executables = ["nc", "netcat", "wget", "curl"]
  }
  
  # File integrity monitoring
  file_integrity_monitoring {
    enabled             = true
    monitored_files     = ["/app/config.json", "/etc/passwd"]
    monitored_files_read = true
    monitored_files_modify = true
  }
  
  # Malware protection
  malware_scan_options {
    enabled            = true
    action             = "Alert"
    include_directories = ["/app"]
    exclude_directories = ["/tmp"]
  }
  
  # Additional security settings
  block_fileless_exec = true
  block_non_compliant_workloads = true
  block_disallowed_images = true
  enable_crypto_mining_dns = true
}
```

## Import

Function runtime policies can be imported using the policy name:

```shell
terraform import aquasec_function_runtime_policy.policy_name policy_name
```

For example:

```shell
terraform import aquasec_function_runtime_policy.function-runtime-audit function-runtime-audit
```

This allows you to bring existing function runtime policies under Terraform management.

### Required

- `name` (String) Name of the function runtime policy

### Optional

- `application_scopes` (List of String) Indicates the application scope of the function runtime policy.
- `block_disallowed_images` (Boolean) Block deployment from disallowed images.
- `block_fileless_exec` (Boolean) Block fileless execution attempts.
- `block_non_compliant_workloads` (Boolean) Block non-compliant serverless functions.
- `description` (String) The description of the function runtime policy.
- `enable_crypto_mining_dns` (Boolean) Enable detection of crypto mining via DNS monitoring.
- `enabled` (Boolean) Indicates if the runtime policy is enabled or not. Defaults to `true`.
- `enforce` (Boolean) Indicates that policy should effect function execution (not just for audit). Defaults to `false`.
- `enforce_after_days` (Number) Indicates the number of days after which the runtime policy will be changed to enforce mode.
- `exclude_application_scopes` (List of String) List of excluded application scopes.
- `is_auto_generated` (Boolean) Indicates if the policy was auto-generated.
- `is_ootb_policy` (Boolean) Indicates if this is an out-of-the-box policy.
- `is_audit_checked` (Boolean) Indicates if audit check is enabled.
- `runtime_type` (String) Type of runtime policy. Defaults to `function`.
- `scope` (Block List) Scope configuration. (see [below for nested schema](#nestedblock--scope))
- `scope_expression` (String) Logical expression of how to compute the dependency of the scope variables.
- `scope_variables` (Block List) List of scope attributes. (see [below for nested schema](#nestedblock--scope_variables))
- `type` (String) Policy type identifier. Defaults to `runtime.policy`.
- `version` (String) Version of the function runtime policy. Defaults to `1.0`.

### Security Controls

- `allowed_executables` (Block List) Allowed executables configuration. (see [below for nested schema](#nestedblock--allowed_executables))
- `drift_prevention` (Block List) Drift prevention configuration for functions. (see [below for nested schema](#nestedblock--drift_prevention))
- `executable_blacklist` (Block List) Executable blacklist configuration. (see [below for nested schema](#nestedblock--executable_blacklist))
- `file_integrity_monitoring` (Block List) Configuration for file integrity monitoring. (see [below for nested schema](#nestedblock--file_integrity_monitoring))
- `malware_scan_options` (Block List, Max: 1) Configuration for Real-Time Malware Protection. (see [below for nested schema](#nestedblock--malware_scan_options))
- `tripwire` (Block List, Max: 1) Honeypot/tripwire configuration for detecting unauthorized access. (see [below for nested schema](#nestedblock--tripwire))

### Read-Only

- `id` (String) The ID of this resource.
- `author` (String) Username of the account that created the policy.
- `created` (String) Creation timestamp.
- `updated` (String) Last update timestamp.
- `lastupdate` (Number) Internal last update tracker.

<a id="nestedblock--allowed_executables"></a>
### Nested Schema for `allowed_executables`

Optional:

- `enabled` (Boolean) Whether allowed executables configuration is enabled.
- `allow_executables` (List of String) List of allowed executables.
- `separate_executables` (Boolean) Whether to treat executables separately.
- `allow_root_executables` (List of String) List of allowed root executables.

<a id="nestedblock--drift_prevention"></a>
### Nested Schema for `drift_prevention`

Optional:

- `enabled` (Boolean) Whether drift prevention is enabled.
- `exec_lockdown` (Boolean) Whether to lockdown execution drift.
- `image_lockdown` (Boolean) Whether to lockdown image drift.
- `exec_lockdown_white_list` (List of String) List of items in the execution lockdown white list.

<a id="nestedblock--executable_blacklist"></a>
### Nested Schema for `executable_blacklist`

Optional:

- `enabled` (Boolean) Whether the executable blacklist is enabled.
- `executables` (List of String) List of blacklisted executables.

<a id="nestedblock--file_integrity_monitoring"></a>
### Nested Schema for `file_integrity_monitoring`

Optional:

- `enabled` (Boolean) If true, file integrity monitoring is enabled.
- `monitored_files` (List of String) List of paths to be monitored.
- `exceptional_monitored_files` (List of String) List of paths to be excluded from monitoring.
- `monitored_files_read` (Boolean) Whether to monitor file read operations.
- `monitored_files_modify` (Boolean) Whether to monitor file modify operations.
- `monitored_files_attributes` (Boolean) Whether to monitor file attribute operations.
- `monitored_files_create` (Boolean) Whether to monitor file create operations.
- `monitored_files_delete` (Boolean) Whether to monitor file delete operations.
- `monitored_files_processes` (List of String) List of processes associated with monitored files.
- `exceptional_monitored_files_processes` (List of String) List of processes to be excluded from monitoring.
- `monitored_files_users` (List of String) List of users associated with monitored files.
- `exceptional_monitored_files_users` (List of String) List of users to be excluded from monitoring.

<a id="nestedblock--malware_scan_options"></a>
### Nested Schema for `malware_scan_options`

Optional:

- `enabled` (Boolean) Defines if malware scanning is enabled or not.
- `action` (String) Set Action, Defaults to 'Alert' when empty.
- `include_directories` (List of String) List of directories to include in scanning.
- `exclude_directories` (List of String) List of directories to exclude from scanning.
- `exclude_processes` (List of String) List of processes to exclude from scanning.

<a id="nestedblock--tripwire"></a>
### Nested Schema for `tripwire`

Optional:

- `enabled` (Boolean) Whether the honeypot is enabled.
- `user_id` (String) Honeypot User ID (Access Key).
- `user_password` (String, Sensitive) Honeypot User Password (Secret Key).
- `apply_on` (List of String) List of options to apply the honeypot on (Environment Variable, Layer, File).
- `serverless_app` (String) Serverless application name.

<a id="nestedblock--scope"></a>
### Nested Schema for `scope`

Required:

- `expression` (String) Scope expression.
- `variables` (Block List, Min: 1) List of variables in the scope. (see [below for nested schema](#nestedblock--scope--variables))

<a id="nestedblock--scope--variables"></a>
### Nested Schema for `scope.variables`

Required:

- `attribute` (String) Variable attribute.
- `value` (String) Variable value.

Optional:

- `name` (String) Name assigned to the attribute.

<a id="nestedblock--scope_variables"></a>
### Nested Schema for `scope_variables`

Required:

- `attribute` (String) Class of supported scope.
- `value` (String) Value assigned to the attribute.

Optional:

- `name` (String) Name assigned to the attribute.